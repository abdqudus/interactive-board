(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{65275:function(e,s,l){Promise.resolve().then(l.bind(l,965))},13141:function(e,s,l){"use strict";var t=l(3827);l(64090),s.Z=e=>{var s,l,a,n,r;let{session:i,owner:d,isRoom:c,room:o,isLoadingRoom:u,participantCount:m}=e,x=c&&(null==o?void 0:o.name),h=c&&!u,f=(null==d?void 0:d.id)===(null==i?void 0:i.user.id);return(0,t.jsx)("nav",{className:"bg-white z-20 border border-slate-200 w-full p-4",children:(0,t.jsxs)("div",{className:"mx-auto flex justify-between items-center",children:[(0,t.jsxs)("section",{className:"flex gap-2 items-center",children:[(0,t.jsx)("a",{href:"/",className:"text-lg font-semibold md:text-2xl text-blue-500",children:"Guess Draw"}),x&&(0,t.jsxs)("div",{className:"hidden md:flex  gap-2",children:[(0,t.jsx)("span",{className:"text-slate-400",children:"\xb7"}),(0,t.jsx)("h3",{className:"text-slate-500",children:null==o?void 0:o.name})]}),h&&(0,t.jsxs)("div",{className:"hidden md:flex  gap-2",children:[(0,t.jsx)("span",{className:"text-slate-400",children:"\xb7"}),(0,t.jsx)("span",{className:"rounded-full text-xs font-medium bg-green-100 py-1 px-2 text-green-600",children:(null==o?void 0:o.isPublic)?"Public":"Private"})]}),d&&(0,t.jsxs)("div",{className:"hidden lg:flex gap-2",children:[(0,t.jsx)("span",{className:"text-slate-400",children:"\xb7"}),(0,t.jsxs)("h3",{className:"text-slate-500",children:["Owned by ",null==d?void 0:null===(s=d.user_metadata)||void 0===s?void 0:s.userName," ",f&&(0,t.jsx)(t.Fragment,{children:"(You)"})]})]}),m?(0,t.jsxs)("div",{className:"hidden md:flex  gap-2",children:[(0,t.jsx)("span",{className:"text-slate-400",children:"\xb7"}),(0,t.jsxs)("h3",{className:"text-slate-500",children:[m," participants"]})]}):null,!c&&i&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"text-slate-400",children:"\xb7"}),(0,t.jsxs)("h3",{className:"text-slate-500",children:["Welcome back @",null==i?void 0:null===(a=i.user)||void 0===a?void 0:null===(l=a.user_metadata)||void 0===l?void 0:l.userName]})]})]}),(0,t.jsxs)("section",{className:"flex items-center gap-2",children:[c&&(0,t.jsxs)("a",{href:"/",target:"_blank",className:"flex items-center font-semibold text-sm px-2.5 py-2 rounded-full gap-1 bg-blue-600 text-white hover:bg-blue-500",children:[(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 6H5.25A2.25 2.25 0 003 8.25v10.5A2.25 2.25 0 005.25 21h10.5A2.25 2.25 0 0018 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"})}),(0,t.jsx)("span",{children:"Dashboard"})]}),(0,t.jsx)("div",{className:"h-10 w-10 overflow-hidden rounded-full",style:{background:null==i?void 0:null===(r=i.user)||void 0===r?void 0:null===(n=r.user_metadata)||void 0===n?void 0:n.userColor}})]})]})})}},44239:function(e,s,l){"use strict";l.d(s,{O:function(){return n},c:function(){return r}});var t=l(67733);let a="https://ybxbwpwzpqtkqzytfjol.supabase.co",n=(0,t.eI)(a,"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlieGJ3cHd6cHF0a3F6eXRmam9sIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MDc3NDM0MzYsImV4cCI6MjAyMzMxOTQzNn0.JrNuycBKUf7-vMglBmuCY9kfSM8kwtMkIxibuonEAWE"),r=(0,t.eI)(a,"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlieGJ3cHd6cHF0a3F6eXRmam9sIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTcwNzc0MzQzNiwiZXhwIjoyMDIzMzE5NDM2fQ.PbNJ-I_loVTNYB0ScLrvSh-y4oH2QU_V1glI2CrxsPI",{auth:{autoRefreshToken:!1,persistSession:!1}}).auth.admin},965:function(e,s,l){"use strict";l.r(s),l.d(s,{default:function(){return v}});var t=l(3827),a=l(13141),n=l(64090),r=l(69767),i=l(44239),d=l(47907),c=l(8792);let o=e=>{let{id:s,name:l,created_at:a,isPublic:n}=e,r=new Date(a);return(0,t.jsxs)(c.default,{href:"/room/".concat(s),className:"flex items-start border border-slate-200 p-5 rounded-md justify-between w-full",children:[(0,t.jsxs)("div",{className:"flex gap-3 flex-col w-full",children:[(0,t.jsx)("h2",{className:"font-medium text-lg text-blue-500 capitalize",children:l}),(0,t.jsxs)("span",{className:"text-xs text-slate-500",children:["Created at ",r.getDate(),"/",r.getMonth(),"/",r.getFullYear()]})]}),(0,t.jsx)("span",{className:"rounded-full text-xs font-medium bg-green-100 py-1 px-2 text-green-600",children:n?"Public":"Private"})]})};var u=l(46201),m=e=>{let{session:s,show:l,setShow:a,loadUserDrawingRooms:r}=e,[i,d]=(0,n.useState)(""),[c,o]=(0,n.useState)(!1),[m,x]=(0,n.useState)(!1);return(0,t.jsx)(t.Fragment,{children:l&&(0,t.jsxs)("div",{className:"fixed w-full inset-0",children:[(0,t.jsx)("div",{className:"absolute bg-black/50 w-full h-full",onClick:()=>!m&&a(!1)}),(0,t.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,t.jsxs)("form",{className:"bg-white relative z-10 flex flex-col gap-5 p-5 rounded",onSubmit:async e=>{var l;e.preventDefault(),x(!0);let t=await (0,u.f6)(i,null==s?void 0:null===(l=s.user)||void 0===l?void 0:l.id,c);r(),window.location.href="/room/".concat(t[0].id)},children:[(0,t.jsx)("h2",{className:"text-slate-700 text-lg",children:"Create new room"}),(0,t.jsx)("div",{className:"flex flex-col gap-2",children:(0,t.jsx)("input",{type:"text",placeholder:"Room Name",className:"border border-slate-300 py-2.5 px-3 rounded",onChange:e=>d(e.target.value),value:i})}),(0,t.jsxs)("div",{className:"flex gap-1 items-center text-slate-700 text-sm",children:[(0,t.jsx)("label",{children:"Public"}),(0,t.jsx)("input",{type:"checkbox",placeholder:"Room Name",className:"border border-slate-300 rounded",checked:c,onChange:e=>o(e.target.checked)})]}),(0,t.jsx)("button",{className:"font-semibold text-sm px-2.5 py-2 rounded-full gap-1 bg-blue-600 text-white hover:bg-blue-500",type:"submit",disabled:m,children:m?"Please wait...":"Create"})]})})]})})},x=e=>{var s,l;let{session:a,setShowCreateRoomModal:n}=e;return(0,t.jsxs)("section",{className:"w-full flex justify-between items-center",children:[(0,t.jsxs)("h3",{className:"text-slate-600",children:["Welcome back, @",null==a?void 0:null===(l=a.user)||void 0===l?void 0:null===(s=l.user_metadata)||void 0===s?void 0:s.userName," \uD83D\uDC4B\uD83C\uDFFD"]}),(0,t.jsxs)("button",{className:"flex items-center font-semibold text-sm px-2.5 py-2 rounded-full gap-1 bg-blue-600 text-white hover:bg-blue-500",onClick:()=>n(!0),children:[(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"{1.5}",stroke:"currentColor",className:"w-5 h-5",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v6m3-3H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,t.jsx)("span",{children:"New Room"})]})]})};let h=()=>(0,t.jsxs)("div",{className:"flex gap-2 items-start border border-slate-200 p-5 rounded-md justify-between w-full",children:[(0,t.jsxs)("div",{className:"flex gap-3 flex-col w-full",children:[(0,t.jsx)("h2",{className:"bg-slate-100 rounded-md w-full",children:(0,t.jsx)("span",{className:"invisible",children:"Name"})}),(0,t.jsx)("p",{className:"bg-slate-100 rounded-md w-1/2",children:(0,t.jsx)("span",{className:"invisible",children:"Created"})})]}),(0,t.jsx)("span",{className:"bg-slate-100 rounded-full text-xs py-1 px-2",children:(0,t.jsx)("span",{className:"invisible",children:"Public"})})]});var f=e=>{var s;let{session:l}=e,a=(0,d.usePathname)(),[r,i]=(0,n.useState)(null),[c,f]=(0,n.useState)(!0),[v,p]=(0,n.useState)(!1),j=!c&&(null==r?void 0:r.length)===0,w=r&&r.length>=0,g=async()=>{var e;return(0,u.fz)(null==l?void 0:null===(e=l.user)||void 0===e?void 0:e.id).then(e=>{i(e)})};return(0,n.useEffect)(()=>{var e;(null==l?void 0:null===(e=l.user)||void 0===e?void 0:e.id)&&g().then(e=>{f(!1)})},[null==l?void 0:null===(s=l.user)||void 0===s?void 0:s.id]),(0,t.jsxs)("div",{className:"max-w-5xl flex flex-col gap-10 mx-auto px-4 pt-10",children:["/"===a&&(0,t.jsx)(x,{session:l,setShowCreateRoomModal:p}),j&&(0,t.jsx)("p",{className:"text-slate-600 text-center mt-3",children:"Your drawing rooms will display here when you create new rooms."}),(0,t.jsxs)("section",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[c&&(0,t.jsx)(t.Fragment,{children:[,,,,,].fill(5).map((e,s)=>(0,t.jsx)(h,{},s))}),!c&&w&&(0,t.jsx)(t.Fragment,{children:null==r?void 0:r.map(e=>{let{id:s,name:l,created_at:a,isPublic:n}=e;return(0,t.jsx)(o,{id:s,name:l,created_at:a,isPublic:n},s)})})]}),(0,t.jsx)(m,{show:v,setShow:p,loadUserDrawingRooms:g,session:l})]})};function v(){let[e,s]=(0,n.useState)(),[l,d]=(0,n.useState)(!0);return((0,n.useEffect)(()=>{(0,r.cw)().then(e=>{if(e){var l,t,a,n,r;if(!(null==e?void 0:null===(t=e.user)||void 0===t?void 0:null===(l=t.user_metadata)||void 0===l?void 0:l.userName)&&!(null==e?void 0:null===(n=e.user)||void 0===n?void 0:null===(a=n.user_metadata)||void 0===a?void 0:a.userColor)){let l=function(e){try{return null==e?void 0:e.split("@")[0]}catch(e){throw Error("Error occurred while creating username: "+e)}}(null==e?void 0:null===(r=e.user)||void 0===r?void 0:r.email),t=function(){let e=["#3b82f6","#14b8a6","#f87171","#eab308","#a855f7","#6366f1"],s=Math.floor(Math.random()*e.length);return e[s]}();i.O.auth.updateUser({data:{userName:l,userColor:t}}),s({...null==e?void 0:e.user,user_metadata:{userName:l,userColor:t}}),d(!1)}s(e),d(!1)}else window.location.href="/login"}).catch(e=>{throw Error("Error occurred while fetching user session: "+e)})},[]),l)?(0,t.jsx)("div",{className:"min-h-screen flex justify-center items-center",children:(0,t.jsx)("p",{children:"Validating session. please wait..."})}):(0,t.jsxs)("main",{children:[(0,t.jsx)(a.Z,{session:e}),(0,t.jsx)(f,{session:e})]})}},46201:function(e,s,l){"use strict";l.d(s,{Dv:function(){return d},f6:function(){return n},fz:function(){return r},rc:function(){return i}});var t=l(44239);let a="drawing-rooms",n=async(e,s,l)=>{let{data:n,error:r}=await t.O.from(a).insert({name:e,owner:s,isPublic:l,isPasswordProtected:!1,password:null,created_at:new Date().toISOString()}).select();return r||n},r=async e=>{let{data:s}=await t.O.from(a).select().eq("owner",e).order("created_at",{ascending:!1});return s},i=async e=>{let{data:s,error:l}=await t.O.from(a).select().eq("id",e);return l||s},d=async(e,s)=>{await t.O.from(a).update({drawing:s}).eq("id",e).select()}},69767:function(e,s,l){"use strict";l.d(s,{Jx:function(){return r},Mi:function(){return n},cw:function(){return a}});var t=l(44239);let a=async()=>{let{data:e,error:s}=await t.O.auth.getSession();return e.session},n=async e=>{let{data:s}=await t.c.getUserById(e);return s},r=async e=>{let s=await fetch("/api/generate-user-video-instance",{method:"POST",body:JSON.stringify({userId:e})});return await s.json()}}},function(e){e.O(0,[733,901,971,69,744],function(){return e(e.s=65275)}),_N_E=e.O()}]);